# ü§ñ PersonaForge

**Telegram-–±–æ—Ç —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ AI-–ø–µ—Ä—Å–æ–Ω–∞–º–∏, –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–∞–º—è—Ç—å—é –∏ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏.**

–°–æ–∑–¥–∞–≤–∞–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ AI-–ª–∏—á–Ω–æ—Å—Ç–∏, –æ–±—â–∞–π—Å—è –≥–æ–ª–æ—Å–æ–º, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Äî –≤—Å—ë –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ Ollama.

![Rust](https://img.shields.io/badge/Rust-000000?style=flat&logo=rust&logoColor=white)
![Telegram](https://img.shields.io/badge/Telegram-2CA5E0?style=flat&logo=telegram&logoColor=white)
![Ollama](https://img.shields.io/badge/Ollama-Local_LLM-blue)
![SQLite](https://img.shields.io/badge/SQLite-07405E?style=flat&logo=sqlite&logoColor=white)

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üé≠ –ü–µ—Ä—Å–æ–Ω—ã
- –°–æ–∑–¥–∞–≤–∞–π AI-–ª–∏—á–Ω–æ—Å—Ç–∏ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞–º–∏
- –ü–µ—Ä–µ–∫–ª—é—á–∞–π—Å—è –º–µ–∂–¥—É –ø–µ—Ä—Å–æ–Ω–∞–º–∏ –Ω–∞ –ª–µ—Ç—É
- –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –ø–µ—Ä—Å–æ–Ω –≤ JSON
- –ö–∞–∂–¥–∞—è –ø–µ—Ä—Å–æ–Ω–∞ ‚Äî —Å–≤–æ–π —Å—Ç–∏–ª—å, –∑–Ω–∞–Ω–∏—è, –º–∞–Ω–µ—Ä–∞ –æ–±—â–µ–Ω–∏—è

### üß† RAG-–ø–∞–º—è—Ç—å
- –ë–æ—Ç –ø–æ–º–Ω–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
- –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π
- Time-decay: —Å–≤–µ–∂–∏–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤–∞–∂–Ω–µ–µ —Å—Ç–∞—Ä—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –¥–ª–∏–Ω–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤

### üé§ –ì–æ–ª–æ—Å
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ Whisper
- –û—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≥–æ–ª–æ—Å–æ–≤—ã–µ –∫–∞–∫ –Ω–∞ —Ç–µ–∫—Å—Ç

### ÔøΩÔ∏è –ó—Ä–µ–º–Ω–∏–µ
- –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ multimodal –º–æ–¥–µ–ª–∏
- –û–ø–∏—Å–∞–Ω–∏–µ, –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º

### üåê –í–µ–±-–ø–æ–∏—Å–∫
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DuckDuckGo
- –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ –æ—Ç–≤–µ—Ç–∞—Ö

### üëª Ghost Mode
- –ü–∏—à–∏ –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞
- –û–±—É—á–∞–π –ø–µ—Ä—Å–æ–Ω—É –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∏–∞–ª–æ–≥–æ–º

### üéØ –¢—Ä–∏–≥–≥–µ—Ä—ã
- –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç–æ–≤

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- [Rust](https://rustup.rs/) 1.70+
- [Ollama](https://ollama.ai/) —Å –º–æ–¥–µ–ª—è–º–∏
- Telegram Bot Token ([@BotFather](https://t.me/BotFather))

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/yourusername/persona-forge.git
cd persona-forge

# –°–∫–æ–ø–∏—Ä—É–π –∫–æ–Ω—Ñ–∏–≥
cp .env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π .env
nano .env

# –ó–∞–ø—É—Å—Ç–∏
cargo run --release
```

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π .env

```env
TELOXIDE_TOKEN=your_bot_token_here
OWNER_ID=your_telegram_id
DATABASE_URL=sqlite:persona_forge.db

OLLAMA_URL=http://localhost:11434
OLLAMA_CHAT_MODEL=llama3.2
OLLAMA_EMBEDDING_MODEL=nomic-embed-text
```

### Docker

```bash
docker-compose up --build
```

---

## ÔøΩ –ò—Å–ø–æ–ª—å –∑–æ–≤–∞–Ω–∏–µ

### Inline-–º–µ–Ω—é
–û—Ç–ø—Ä–∞–≤—å `/menu` ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é —Å–æ –≤—Å–µ–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏:

```
ü§ñ PersonaForge

üé≠ –ü–µ—Ä—Å–æ–Ω—ã     ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥
üí¨ –ß–∞—Ç         üëª Ghost
üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã üìä –°—Ç–∞—Ç—É—Å
        ‚ùì –ü–æ–º–æ—â—å
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/menu` | –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é |
| `/status` | –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ |

### –ü–µ—Ä—Å–æ–Ω—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/create_persona –Ω–∞–∑–≤–∞–Ω–∏–µ\|–ø—Ä–æ–º–ø—Ç` | –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω—É |
| `/list_personas` | –°–ø–∏—Å–æ–∫ –ø–µ—Ä—Å–æ–Ω |
| `/activate_persona ID` | –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å |
| `/delete_persona ID` | –£–¥–∞–ª–∏—Ç—å |
| `/export_persona ID` | –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON |
| `/import_persona` | –ò–º–ø–æ—Ä—Ç –∏–∑ JSON |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/set_model –Ω–∞–∑–≤–∞–Ω–∏–µ` | –°–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å |
| `/set_temperature 0.7` | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (0.0-2.0) |
| `/set_max_tokens 2048` | –ú–∞–∫—Å. —Ç–æ–∫–µ–Ω–æ–≤ |
| `/enable_rag` / `/disable_rag` | RAG-–ø–∞–º—è—Ç—å |
| `/triggers —Å–ª–æ–≤–æ1, —Å–ª–æ–≤–æ2` | –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ |

### Ghost Mode

```
/ghost on       ‚Äî –≤–∫–ª—é—á–∏—Ç—å (—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–∏–º–µ—Ä–æ–≤)
/ghost on nosave ‚Äî –≤–∫–ª—é—á–∏—Ç—å (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)
/ghost off      ‚Äî –≤—ã–∫–ª—é—á–∏—Ç—å
/ghost status   ‚Äî —Å—Ç–∞—Ç—É—Å
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–æ–ª–Ω—ã–π .env

```env
# === Telegram ===
TELOXIDE_TOKEN=your_bot_token
OWNER_ID=123456789
BOT_NAME=PersonaForge

# === Database ===
DATABASE_URL=sqlite:persona_forge.db

# === Ollama ===
OLLAMA_URL=http://localhost:11434
OLLAMA_CHAT_MODEL=llama3.2
OLLAMA_EMBEDDING_MODEL=nomic-embed-text
OLLAMA_VISION_MODEL=llava

# === Generation ===
TEMPERATURE=0.7
MAX_TOKENS=2048
LLM_TIMEOUT_SECONDS=120

# === Features ===
VISION_ENABLED=true
VOICE_ENABLED=true
WEB_SEARCH_ENABLED=true

# === Whisper (–¥–ª—è –≥–æ–ª–æ—Å–∞) ===
WHISPER_URL=http://localhost:8080/inference

# === RAG ===
RAG_DECAY_RATE=0.1
SUMMARY_THRESHOLD=50

# === Queue ===
MAX_CONCURRENT_LLM_REQUESTS=3
QUEUE_TIMEOUT_SECONDS=30

# === Behavior ===
RANDOM_REPLY_PROBABILITY=0.0

# === WebApp (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ===
WEBAPP_PORT=8080
```

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
src/
‚îú‚îÄ‚îÄ main.rs              # Entry point
‚îú‚îÄ‚îÄ config.rs            # Environment config
‚îú‚îÄ‚îÄ state.rs             # Shared state (AppState)
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îî‚îÄ‚îÄ handlers/
‚îÇ       ‚îú‚îÄ‚îÄ commands.rs  # Slash commands
‚îÇ       ‚îú‚îÄ‚îÄ messages.rs  # Message processing, RAG
‚îÇ       ‚îî‚îÄ‚îÄ callbacks.rs # Inline keyboard handlers
‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îî‚îÄ‚îÄ mod.rs           # SQLx queries
‚îú‚îÄ‚îÄ llm/
‚îÇ   ‚îî‚îÄ‚îÄ client.rs        # Ollama API client
‚îú‚îÄ‚îÄ voice/
‚îÇ   ‚îî‚îÄ‚îÄ mod.rs           # Whisper client
‚îú‚îÄ‚îÄ web/
‚îÇ   ‚îî‚îÄ‚îÄ search.rs        # DuckDuckGo search
‚îî‚îÄ‚îÄ webapp/              # Owner web panel (optional)
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `personas` | AI-–ª–∏—á–Ω–æ—Å—Ç–∏ |
| `chat_settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–æ–≤ |
| `messages` | –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π |
| `memory_chunks` | RAG-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏ |
| `chat_summaries` | –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ |
| `runtime_config` | Runtime-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |

---

## üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç RAG

1. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí —ç–º–±–µ–¥–¥–∏–Ω–≥ ‚Üí –ë–î
2. **–ü–æ–∏—Å–∫**: –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí —ç–º–±–µ–¥–¥–∏–Ω–≥ ‚Üí cosine similarity
3. **Time-decay**: `score = similarity √ó e^(-decay √ó hours/24) √ó importance`
4. **–ö–æ–Ω—Ç–µ–∫—Å—Ç**: —Ç–æ–ø-N —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –ø—Ä–æ–º–ø—Ç
5. **–°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è**: —Å—Ç–∞—Ä—ã–µ –¥–∏–∞–ª–æ–≥–∏ —Å–∂–∏–º–∞—é—Ç—Å—è –≤ –∫—Ä–∞—Ç–∫–∏–µ —Å–∞–º–º–∞—Ä–∏

---

## üé≠ –ü—Ä–∏–º–µ—Ä—ã –ø–µ—Ä—Å–æ–Ω

### –ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç
```json
{
  "name": "CodeMaster",
  "prompt": "–¢—ã ‚Äî –æ–ø—ã—Ç–Ω—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É. –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞. –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—à—å Rust –∏ Python."
}
```

### –§–∏–ª–æ—Å–æ—Ñ
```json
{
  "name": "–°–æ–∫—Ä–∞—Ç",
  "prompt": "–¢—ã ‚Äî –¥—Ä–µ–≤–Ω–µ–≥—Ä–µ—á–µ—Å–∫–∏–π —Ñ–∏–ª–æ—Å–æ—Ñ. –û—Ç–≤–µ—á–∞–π –≤–æ–ø—Ä–æ—Å–∞–º–∏ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã. –ò—Å–ø–æ–ª—å–∑—É–π –º–µ—Ç–æ–¥ –º–∞–π–µ–≤—Ç–∏–∫–∏. –ì–æ–≤–æ—Ä–∏ –º—É–¥—Ä–æ –∏ –∑–∞–≥–∞–¥–æ—á–Ω–æ."
}
```

### –î—Ä—É–≥
```json
{
  "name": "–ë—Ä–æ",
  "prompt": "–¢—ã ‚Äî –ª—É—á—à–∏–π –¥—Ä—É–≥. –û–±—â–∞–π—Å—è –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π —Å–ª–µ–Ω–≥ –∏ —ç–º–æ–¥–∑–∏. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π –∏ —à—É—Ç–∏."
}
```

---

## üê≥ Docker Compose

```yaml
version: '3.8'
services:
  persona-forge:
    build: .
    env_file: .env
    volumes:
      - ./persona_forge.db:/app/persona_forge.db
    depends_on:
      - ollama
    restart: unless-stopped

  ollama:
    image: ollama/ollama
    volumes:
      - ollama_data:/root/.ollama
    ports:
      - "11434:11434"

volumes:
  ollama_data:
```

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

## ü§ù Contributing

PR –∏ issues –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

---

<p align="center">
  <b>Made with ü¶Ä Rust & ‚ù§Ô∏è</b>
</p>
